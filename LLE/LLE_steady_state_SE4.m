function RHS = LLE_steady_state_SE4(x)
global delta h sigma_X Ein tau0
P = Ein;;

 warning('ON','MATLAB:integral:MinStepSize');
% dt = 0.0001;
% tt = (-100:dt:100);
 x
 
  FIa = @(t,x) 0.1e1 ./ sigma_X .^ 4 .* (-cosh((-t + x(4)) .* x(1)) - t .* x(1) .* sinh((-t + x(4)) .* x(1)) + x(1) .* sinh((-t + x(4)) .* x(1)) .* x(4)) .* ((-1*1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) - 4 .* h .^ 2 .* x(1) .* (t .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) + 4 .* h .^ 2 .* x(1) .* (t .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) - 4 .* h .^ 2 .* x(1) .* (tau0 .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) + 4 .* h .^ 2 .* x(1) .* (tau0 .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-2*1i) .* P .* sigma_X .^ 4 .* (cosh(x(1) .* t) .^ 2) .* (cosh(x(1) .* x(4)) .^ 2) .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) + (1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) .* (cosh(x(1) .* t) .^ 2) + (1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) .* (cosh(x(1) .* x(4)) .^ 2) + (4*1i) .* h .* (x(1) .^ 2) .* sigma_X .^ 2 .* t .* sinh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-4*1i) .* h .* (x(1) .^ 2) .* sigma_X .^ 2 .* t .* cosh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-4*1i) .* h .* (x(1) .^ 2) .* sigma_X .^ 2 .* tau0 .* sinh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (4*1i) .* h .* (x(1) .^ 2) .* sigma_X .^ 2 .* tau0 .* cosh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-8*1i) .* h .* x(1) .* t .* tau0 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (8*1i) .* h .* x(1) .* t .* tau0 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (2*1i) .* P .* sigma_X .^ 4 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) - 8 .* h .* x(1) .* sigma_X .^ 2 .* x(2) .* (t .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 4 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(3) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 4 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(3) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 4 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(3) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 4 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(3) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* x(2) .* (t .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-2*1i) .* h .* x(1) .* sigma_X .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (2*1i) .* h .* x(1) .* sigma_X .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .* (tau0 .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .* (tau0 .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .* (t .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .* (t .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .^ 2 .* x(1) .* t .* tau0 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) - 8 .* h .^ 2 .* x(1) .* t .* tau0 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(2) .* x(4) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* t .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* t .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* x(4) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* x(4) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(2) .* x(4) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2)) ./ (cosh((-t + x(4)) .* x(1)) .^ 4);
  Ia = 2*real(integral(@(t)FIa(t,x),-inf,inf,'AbsTol',1e-15,'RelTol',1e-13));

 FId = @(t,x) (1i) .* x(1) .* (-t + x(4)) .^ 2 .* ((-1*1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) - 4 .* h .^ 2 .* x(1) .* t .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) + 4 .* h .^ 2 .* x(1) .* t .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) - 4 .* h .^ 2 .* x(1) .* tau0 .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) + 4 .* h .^ 2 .* x(1) .* tau0 .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) + (-2*1i) .* P .* sigma_X .^ 4 .* cosh(x(1) .* t) .^ 2 .* cosh(x(1) .* x(4)) .^ 2 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) + (1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) .* cosh(x(1) .* t) .^ 2 + (1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) .* cosh(x(1) .* x(4)) .^ 2 + (4*1i) .* h .* x(1) .^ 2 .* sigma_X .^ 2 .* t .* sinh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .^ 2 .* sigma_X .^ 2 .* t .* cosh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .^ 2 .* sigma_X .^ 2 .* tau0 .* sinh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .^ 2 .* sigma_X .^ 2 .* tau0 .* cosh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-8*1i) .* h .* x(1) .* t .* tau0 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (8*1i) .* h .* x(1) .* t .* tau0 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (2*1i) .* P .* sigma_X .^ 4 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) - 8 .* h .* x(1) .* sigma_X .^ 2 .* x(2) .* t .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 4 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(3) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 4 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(3) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 4 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(3) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 4 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(3) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* x(2) .* t .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-2*1i) .* h .* x(1) .* sigma_X .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (2*1i) .* h .* x(1) .* sigma_X .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .* tau0 .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .* tau0 .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .* t .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .* t .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .^ 2 .* x(1) .* t .* tau0 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) - 8 .* h .^ 2 .* x(1) .* t .* tau0 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(2) .* x(4) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* t .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* t .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* x(4) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* x(4) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(2) .* x(4) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2)) ./ sigma_X .^ 4 ./ cosh((-t + x(4)) .* x(1)) .^ 3;
 Id = 2*real(integral(@(t)FId(t,x),-inf,inf,'AbsTol',1e-15,'RelTol',1e-13));
 
 FIc = @(t,x) (-1*1i) .* x(1) .* (-t + x(4)) .* ((-1*1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) - 4 .* h .^ 2 .* x(1) .* t .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) + 4 .* h .^ 2 .* x(1) .* t .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) - 4 .* h .^ 2 .* x(1) .* tau0 .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) + 4 .* h .^ 2 .* x(1) .* tau0 .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) + (-2*1i) .* P .* sigma_X .^ 4 .* cosh(x(1) .* t) .^ 2 .* cosh(x(1) .* x(4)) .^ 2 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) + (1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) .* cosh(x(1) .* t) .^ 2 + (1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) .* cosh(x(1) .* x(4)) .^ 2 + (4*1i) .* h .* x(1) .^ 2 .* sigma_X .^ 2 .* t .* sinh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .^ 2 .* sigma_X .^ 2 .* t .* cosh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .^ 2 .* sigma_X .^ 2 .* tau0 .* sinh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .^ 2 .* sigma_X .^ 2 .* tau0 .* cosh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-8*1i) .* h .* x(1) .* t .* tau0 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (8*1i) .* h .* x(1) .* t .* tau0 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (2*1i) .* P .* sigma_X .^ 4 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) - 8 .* h .* x(1) .* sigma_X .^ 2 .* x(2) .* t .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 4 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(3) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 4 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(3) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 4 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(3) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 4 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(3) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* x(2) .* t .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-2*1i) .* h .* x(1) .* sigma_X .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (2*1i) .* h .* x(1) .* sigma_X .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .* tau0 .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .* tau0 .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .* t .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .* t .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .^ 2 .* x(1) .* t .* tau0 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) - 8 .* h .^ 2 .* x(1) .* t .* tau0 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* (t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(2) .* x(4) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* t .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* t .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* x(4) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* x(4) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(2) .* x(4) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-(t - tau0) .^ 2 ./ sigma_X .^ 2)) ./ sigma_X .^ 4 ./ cosh((-t + x(4)) .* x(1)) .^ 3;
 Ic = 2*real(integral(@(t)FIc(t,x),-inf,inf,'AbsTol',1e-15,'RelTol',1e-13));
 
 FIxi = @(t,x) -2 .* x(1) ./ sigma_X .^ 4 .* (-(x(1) .* sinh((-t + x(4)) .* x(1))) + (2*1i) .* cosh((-t + x(4)) .* x(1)) .* x(2) .* t + (-2*1i) .* cosh((-t + x(4)) .* x(1)) .* x(2) .* x(4) + (1i) .* cosh((-t + x(4)) .* x(1)) .* x(3)) .* ((-1*1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) - 4 .* h .^ 2 .* x(1) .* (t .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) + 4 .* h .^ 2 .* x(1) .* (t .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) - 4 .* h .^ 2 .* x(1) .* (tau0 .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) + 4 .* h .^ 2 .* x(1) .* (tau0 .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-2*1i) .* P .* sigma_X .^ 4 .* (cosh(x(1) .* t) .^ 2) .* (cosh(x(1) .* x(4)) .^ 2) .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) + (1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) .* (cosh(x(1) .* t) .^ 2) + (1i) .* P .* sigma_X .^ 4 .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) .* (cosh(x(1) .* x(4)) .^ 2) + (4*1i) .* h .* (x(1) .^ 2) .* sigma_X .^ 2 .* t .* sinh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-4*1i) .* h .* (x(1) .^ 2) .* sigma_X .^ 2 .* t .* cosh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-4*1i) .* h .* (x(1) .^ 2) .* sigma_X .^ 2 .* tau0 .* sinh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (4*1i) .* h .* (x(1) .^ 2) .* sigma_X .^ 2 .* tau0 .* cosh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-8*1i) .* h .* x(1) .* t .* tau0 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (8*1i) .* h .* x(1) .* t .* tau0 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (2*1i) .* P .* sigma_X .^ 4 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp((1i) .* (-t + x(4)) .* (x(2) .* t - x(2) .* x(4) + x(3))) - 8 .* h .* x(1) .* sigma_X .^ 2 .* x(2) .* (t .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 4 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(3) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 4 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(3) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 4 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(3) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 4 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(3) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* x(2) .* (t .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-2*1i) .* h .* x(1) .* sigma_X .^ 2 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (2*1i) .* h .* x(1) .* sigma_X .^ 2 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .* (tau0 .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .* (tau0 .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (4*1i) .* h .* x(1) .* (t .^ 2) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + (-4*1i) .* h .* x(1) .* (t .^ 2) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .^ 2 .* x(1) .* t .* tau0 .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) - 8 .* h .^ 2 .* x(1) .* t .* tau0 .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-2 .* ((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(2) .* x(4) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* t .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* t .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) + 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* x(4) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* tau0 .* x(2) .* x(4) .* sinh(x(1) .* t) .* sinh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2) - 8 .* h .* x(1) .* sigma_X .^ 2 .* t .* x(2) .* x(4) .* cosh(x(1) .* t) .* cosh(x(1) .* x(4)) .* exp(-((t - tau0) .^ 2) ./ sigma_X .^ 2)) ./ (cosh((-t + x(4)) .* x(1)) .^ 4);
 Ixi = 2*real(integral(@(t)FIxi(t,x),-inf,inf,'AbsTol',1e-15,'RelTol',1e-13)); 

 warning('ON','MATLAB:integral:MinStepSize');
  Ixi
  Ia
  Ic
  Id
%  
%  if isnan(Ixi)==1
%      Ixi = 0;
%  end 
%  if isnan(Ia)==1
%      Ia = 0;
%  end 

 % Q = (-iu+ delta*u + iS
 FA = -0.2e1 .* x(1) .* (-pi .^ 2 + 0.4e1 .* pi .^ 2 .* x(2) + (3 .* Id .* x(1))) ./ pi .^ 2;
 FD = -0.2e1 .* ((6 .* delta .* x(1) .^ 2) + (6 .* x(1) .^ 2 .* x(3) .^ 2) + (3 .* x(1) .* x(3) .* Ic) + 0.2e1 .* pi .^ 2 .* x(2) .^ 2 - (3 .* Ia .* x(1) .^ 2)) ./ pi .^ 2;
 FC = 0.1e1 ./ pi .^ 2 ./ x(1) .* (-0.8e1 .* pi .^ 2 .* x(1) .* x(3) - pi .^ 2 .* Ixi + 0.16e2 .* pi .^ 2 .* x(2) .* x(1) .* x(3) + 0.12e2 .* Id .* x(1) .^ 2 .* x(3)) ./ 0.2e1;
 FXi = (1 ./ x(1) .* (4 .* x(3) .* x(1) + Ic)) ./ 0.2e1;
 
 RHS =  [FA; FD; FC; FXi]; 
 
 
end

  function y = g(z)
      y = z;
      y(isnan(y)) = 0;
  end